{"version":3,"file":"static/js/300.52ef7f0e.chunk.js","mappings":"mBAGA,MAAMA,EAAcC,KAEpB,IAAIC,GAAY,EAEhB,SAASC,EAAQC,EAAWC,GACxB,GAAID,EAAI,EAAG,OAAO,EAClB,GAAU,IAANA,EAAS,OAAO,EACpB,GAAIA,EAAI,IAAM,EAAG,OAAO,EAExB,MAAME,EAAQC,KAAKC,KAAKJ,GAGxB,IAAK,MAAMK,KAASJ,EAAa,CAC7B,GAAII,EAAQH,EAAO,MACnB,GAAIF,EAAIK,IAAU,EAAG,OAAO,CAChC,CAGA,MAAMC,EAAYL,EAAYM,OAAS,EAAIN,EAAYA,EAAYM,OAAS,GAAK,EACjF,GAAID,EAAYJ,EAAO,CAEnB,IAAK,IAAIM,EADGF,GAAaA,EAAY,IAAM,EAAI,EAAI,GAC/BE,GAAKN,EAAOM,GAAK,EACjC,GAAIR,EAAIQ,IAAM,EAAG,OAAO,CAEhC,CAEA,OAAO,CACX,CAyCAZ,EAAIa,UAAaC,IACb,MAAMC,EAAUD,EAAME,KAEtB,OAAQD,EAAQE,MACZ,IAAK,OACDf,EAAWa,EAAQb,SACnB,MAAMgB,EAA0B,CAC5BD,KAAM,QACNf,YAEJF,EAAImB,YAAYD,GAChB,MAEJ,IAAK,cApDb,SAAsBE,EAAoBC,EAAmBhB,GACzD,MAAMiB,EAAYC,YAAYC,MACxBC,EAAwB,GACxBC,EAAWN,EAAaC,EAAY,EAEpCM,EAAmBpB,KAAKqB,IAAI,IAAMrB,KAAKsB,MAAMR,EAAY,KAE/D,IAAK,IAAIjB,EAAIgB,EAAYhB,GAAKsB,EAAUtB,IAMpC,GALID,EAAQC,EAAGC,IACXoB,EAAYK,KAAK1B,IAIhBA,EAAIgB,GAAcO,IAAqB,GAAKvB,IAAMgB,EAAY,CAC/D,MAAMW,EAA+B,CACjCd,KAAM,WACNf,WACA8B,cAAe5B,EACf6B,mBAAoBR,EAAYd,QAEpCX,EAAImB,YAAYY,EACpB,CAGJ,MAAMG,EAAgBX,YAAYC,MAAQF,EAEpCa,EAAgC,CAClClB,KAAM,eACNf,WACAuB,cACAW,eAAgBf,EAChBD,aACAM,WACAQ,iBAGJlC,EAAImB,YAAYgB,EACpB,CAgBYE,CAAatB,EAAQK,WAAYL,EAAQM,UAAWN,EAAQV,aAC5D,MAEJ,IAAK,OACDiC,QAER,C","sources":["tools/prime-finder/workers/primeWorker.ts"],"sourcesContent":["import { CoordinatorMessage, WorkerMessage, BatchResultMessage, ProgressMessage } from '../data/MessageTypes';\r\n\r\n/* eslint-disable no-restricted-globals */\r\nconst ctx: Worker = self as unknown as Worker;\r\n\r\nlet workerId = -1;\r\n\r\nfunction isPrime(n: number, knownPrimes: number[]): boolean {\r\n    if (n < 2) return false;\r\n    if (n === 2) return true;\r\n    if (n % 2 === 0) return false;\r\n\r\n    const sqrtN = Math.sqrt(n);\r\n\r\n    // First check against known primes\r\n    for (const prime of knownPrimes) {\r\n        if (prime > sqrtN) break;\r\n        if (n % prime === 0) return false;\r\n    }\r\n\r\n    // If knownPrimes doesn't cover sqrt(n), continue with odd numbers\r\n    const lastKnown = knownPrimes.length > 0 ? knownPrimes[knownPrimes.length - 1] : 2;\r\n    if (lastKnown < sqrtN) {\r\n        let start = lastKnown + (lastKnown % 2 === 0 ? 1 : 2);\r\n        for (let i = start; i <= sqrtN; i += 2) {\r\n            if (n % i === 0) return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nfunction processBatch(batchStart: number, batchSize: number, knownPrimes: number[]): void {\r\n    const startTime = performance.now();\r\n    const foundPrimes: number[] = [];\r\n    const batchEnd = batchStart + batchSize - 1;\r\n\r\n    const progressInterval = Math.max(1000, Math.floor(batchSize / 10));\r\n\r\n    for (let n = batchStart; n <= batchEnd; n++) {\r\n        if (isPrime(n, knownPrimes)) {\r\n            foundPrimes.push(n);\r\n        }\r\n\r\n        // Send progress updates periodically\r\n        if ((n - batchStart) % progressInterval === 0 && n !== batchStart) {\r\n            const progressMsg: ProgressMessage = {\r\n                type: 'PROGRESS',\r\n                workerId,\r\n                currentNumber: n,\r\n                primesFoundInBatch: foundPrimes.length\r\n            };\r\n            ctx.postMessage(progressMsg);\r\n        }\r\n    }\r\n\r\n    const computeTimeMs = performance.now() - startTime;\r\n\r\n    const resultMsg: BatchResultMessage = {\r\n        type: 'BATCH_RESULT',\r\n        workerId,\r\n        foundPrimes,\r\n        numbersChecked: batchSize,\r\n        batchStart,\r\n        batchEnd,\r\n        computeTimeMs\r\n    };\r\n\r\n    ctx.postMessage(resultMsg);\r\n}\r\n\r\nctx.onmessage = (event: MessageEvent<CoordinatorMessage>) => {\r\n    const message = event.data;\r\n\r\n    switch (message.type) {\r\n        case 'INIT':\r\n            workerId = message.workerId;\r\n            const readyMsg: WorkerMessage = {\r\n                type: 'READY',\r\n                workerId\r\n            };\r\n            ctx.postMessage(readyMsg);\r\n            break;\r\n\r\n        case 'WORK_BATCH':\r\n            processBatch(message.batchStart, message.batchSize, message.knownPrimes);\r\n            break;\r\n\r\n        case 'STOP':\r\n            close();\r\n            break;\r\n    }\r\n};\r\n"],"names":["ctx","self","workerId","isPrime","n","knownPrimes","sqrtN","Math","sqrt","prime","lastKnown","length","i","onmessage","event","message","data","type","readyMsg","postMessage","batchStart","batchSize","startTime","performance","now","foundPrimes","batchEnd","progressInterval","max","floor","push","progressMsg","currentNumber","primesFoundInBatch","computeTimeMs","resultMsg","numbersChecked","processBatch","close"],"sourceRoot":""}